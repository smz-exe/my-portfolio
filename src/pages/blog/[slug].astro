---
import Layout from '@/layouts/Layout.astro';
import FormattedDate from '@/components/blog/FormattedDate.astro';
import { getCollection } from 'astro:content';
import type { CollectionEntry } from 'astro:content';

export async function getStaticPaths() {
  const posts = await getCollection('blog');
  return posts.map((post) => ({
    params: { slug: post.slug },
    props: post,
  }));
}

const post = Astro.props as CollectionEntry<'blog'>;
const { Content } = await post.render();
---

<Layout title={post.data.title} description={post.data.description}>
  <article class="min-h-screen pb-20">
    <header class="relative overflow-hidden border-b border-neutral-800 bg-neutral-900/30">
      <!-- Grid pattern -->
      <div class="blog-header-grid absolute inset-0"></div>
      <div class="relative z-10 container mx-auto max-w-4xl px-4 py-8 md:pt-20 md:pb-12">
        <a
          href="/blog"
          class="group mb-6 inline-flex items-center gap-2 font-mono text-sm text-neutral-500 transition-colors hover:text-accent"
          aria-label="Back to blog"
        >
          <span class="transition-transform group-hover:-translate-x-1">&lt;</span>
          cd ..
        </a>
        <div
          class="mb-4 flex flex-wrap gap-4 font-mono text-xs tracking-wider text-neutral-500 uppercase"
        >
          <div class="flex items-center gap-2">
            <span class="text-fuchsia-500">@</span>
            <FormattedDate date={post.data.publishedAt} />
          </div>
          {
            post.data.updatedAt && (
              <div class="flex items-center gap-2">
                <span class="text-cyan-500">~</span>
                Updated <FormattedDate date={post.data.updatedAt} />
              </div>
            )
          }
          <div class="flex items-center gap-2">
            <span class="text-neutral-300">[]</span>
            {post.data.tags.join(', ')}
          </div>
        </div>
        <h1
          class="my-6 font-sans text-3xl leading-tight font-bold tracking-tight text-neutral-100 md:text-5xl"
        >
          {post.data.title}
        </h1>
        {
          post.data.description && (
            <p class="text-md font-sans leading-relaxed text-neutral-400 md:text-lg">
              {post.data.description}
            </p>
          )
        }
      </div>
    </header>
    <div class="container mx-auto max-w-4xl px-4 py-12">
      <div class="prose-terminal prose max-w-none prose-neutral prose-invert">
        <Content />
      </div>
    </div>
  </article>
</Layout>
